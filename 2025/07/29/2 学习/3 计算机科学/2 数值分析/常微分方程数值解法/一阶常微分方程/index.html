<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">

	<!-- title -->
	
		<title>
			
				ä¸€é˜¶å¸¸å¾®åˆ†æ–¹ç¨‹ |
					
						Note
		</title>

		<!-- keywords,description -->
		
					

								<!-- favicon -->
								
									<link rel="shortcut icon" href="/favicon.ico">
										


											<!-- search -->
											<script>
												var searchEngine = "";
												if (typeof searchEngine == "undefined" || searchEngine == null || searchEngine == "")
												{
													searchEngine = "https://www.google.com/search?q=";
												}
												var homeHost = "BenChenEternity.github.io";
												if (typeof homeHost == "undefined" || homeHost == null || homeHost == "")
												{
													homeHost = window.location.host;
												}
											</script>


											
<link rel="stylesheet" href="/css/main.css">

												
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

													
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">

														
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">


															
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.0/dist/jquery.min.js"></script>

																
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

																	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

																		
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

																			
<script src="/js/main.js"></script>


																				
																					
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

																						
<script src="https://cdn.jsdelivr.net/npm/valine@v1.5.1/dist/Valine.min.js"></script>

																							
																								
<meta name="generator" content="Hexo 7.3.0"></head>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css"
	integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"
	integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz"
	crossorigin="anonymous"></script>

<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"
	integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
	onload="renderMathInElement(document.body);"></script>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">Note</a>

	<ul id="menu">
    
      <li class="menu-item">
        <a href="/about" class="menu-item-link">About</a>
      </li>
    

    

    

    
  
    
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="Press Enter to search">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										1 hexo
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/09/1%20hexo/1%20%E9%85%8D%E7%BD%AE/">
                     
										    1 é…ç½®
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/30/1%20hexo/2%20hexo%E8%BF%81%E7%A7%BB/">
                     
										    2 hexoè¿ç§»
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/15/1%20hexo/3%20%E6%96%87%E7%AB%A0%E7%BC%96%E5%8F%B7%E7%BC%96%E6%8E%92/">
                     
										    3 æ–‡ç« ç¼–å·ç¼–æ’
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/24/1%20hexo/4%20%E5%85%AC%E5%BC%8F%E5%BC%95%E7%94%A8/">
                     
										    4 å…¬å¼å¼•ç”¨
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/19/1%20hexo/5%20%E5%85%AC%E5%BC%8F%E8%AF%86%E5%88%AB/">
                     
										    5 å…¬å¼è¯†åˆ«
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										2 å­¦ä¹ 
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										1 æ•°å­¦
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/15/2%20%E5%AD%A6%E4%B9%A0/1%20%E6%95%B0%E5%AD%A6/SVD%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3/">
                     
										    å¥‡å¼‚å€¼åˆ†è§£
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										2 åŠ›å­¦
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										1 æµä½“åŠ›å­¦
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/09/2%20%E5%AD%A6%E4%B9%A0/2%20%E5%8A%9B%E5%AD%A6/1%20%E6%B5%81%E4%BD%93%E5%8A%9B%E5%AD%A6/1%20%E6%96%B9%E7%A8%8B%E7%BB%AA%E8%AE%BA/">
                     
										    1 æ–¹ç¨‹ç»ªè®º
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/09/2%20%E5%AD%A6%E4%B9%A0/2%20%E5%8A%9B%E5%AD%A6/1%20%E6%B5%81%E4%BD%93%E5%8A%9B%E5%AD%A6/2%20%E4%BC%AF%E5%8A%AA%E5%88%A9%E6%96%B9%E7%A8%8B/">
                     
										    2 ä¼¯åŠªåˆ©æ–¹ç¨‹
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/23/2%20%E5%AD%A6%E4%B9%A0/2%20%E5%8A%9B%E5%AD%A6/1%20%E6%B5%81%E4%BD%93%E5%8A%9B%E5%AD%A6/3%20N-S%E6%96%B9%E7%A8%8B%E7%9A%84%E8%A7%A3%E6%9E%90%E8%A7%A3/">
                     
										    3 N-Sæ–¹ç¨‹çš„è§£æè§£
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/07/01/2%20%E5%AD%A6%E4%B9%A0/2%20%E5%8A%9B%E5%AD%A6/1%20%E6%B5%81%E4%BD%93%E5%8A%9B%E5%AD%A6/4%20%E6%B9%8D%E6%B5%81/">
                     
										    4 æ¹æµ
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/07/10/2%20%E5%AD%A6%E4%B9%A0/2%20%E5%8A%9B%E5%AD%A6/1%20%E6%B5%81%E4%BD%93%E5%8A%9B%E5%AD%A6/5%20%E7%9B%B8%E4%BC%BC%E5%8E%9F%E7%90%86%E5%92%8C%E9%87%8F%E7%BA%B2%E5%88%86%E6%9E%90/">
                     
										    5 ç›¸ä¼¼åŸç†å’Œé‡çº²åˆ†æ
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										2 è®¡ç®—æµä½“åŠ›å­¦
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										SPHå…‰æ»‘ç²’å­æ³•
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/07/28/2%20%E5%AD%A6%E4%B9%A0/2%20%E5%8A%9B%E5%AD%A6/2%20%E8%AE%A1%E7%AE%97%E6%B5%81%E4%BD%93%E5%8A%9B%E5%AD%A6/SPH%E5%85%89%E6%BB%91%E7%B2%92%E5%AD%90%E6%B3%95/SPH%E6%96%B9%E6%B3%95%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/">
                     
										    SPHæ–¹æ³•åŸºæœ¬åŸç†
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/07/28/2%20%E5%AD%A6%E4%B9%A0/2%20%E5%8A%9B%E5%AD%A6/2%20%E8%AE%A1%E7%AE%97%E6%B5%81%E4%BD%93%E5%8A%9B%E5%AD%A6/SPH%E5%85%89%E6%BB%91%E7%B2%92%E5%AD%90%E6%B3%95/%E7%BB%AA%E8%AE%BA/">
                     
										    ç»ªè®º
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										3 è®¡ç®—æœºç§‘å­¦
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										1 è®¡ç®—æœºå›¾å½¢å­¦
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										1 ç†è®º
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/15/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/1%20%E7%90%86%E8%AE%BA/1%20%E7%BB%AA%E8%AE%BA/">
                     
										    1 ç»ªè®º
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/15/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/1%20%E7%90%86%E8%AE%BA/2%20VAO%20%E4%B8%8E%20VBO/">
                     
										    2 VAO ä¸ VBO
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/09/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/1%20%E7%90%86%E8%AE%BA/3%20%E7%A9%BA%E9%97%B4%E5%8F%98%E6%8D%A2/">
                     
										    3 ç©ºé—´å˜æ¢
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/16/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/1%20%E7%90%86%E8%AE%BA/4%20%E6%AC%A7%E6%8B%89%E8%A7%92/">
                     
										    4 æ¬§æ‹‰è§’
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/19/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/1%20%E7%90%86%E8%AE%BA/5%20%E7%BD%91%E6%A0%BC%E6%9B%B2%E9%9D%A2/">
                     
										    5 ç½‘æ ¼æ›²é¢
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/16/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/1%20%E7%90%86%E8%AE%BA/6%20%E5%85%89%E7%85%A7/">
                     
										    6 å…‰ç…§
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/19/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/1%20%E7%90%86%E8%AE%BA/7%20%E7%BD%91%E6%A0%BC%E6%9B%B2%E9%9D%A2/">
                     
										    7 ç½‘æ ¼æ›²é¢
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										2 å®è·µ
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/09/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/1%20openGL%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/">
                     
										    1 openGLç¯å¢ƒå®‰è£…
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/20/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/2%20%E6%83%B3%E6%B3%95%E6%9E%84%E6%80%9D/">
                     
										    2 æƒ³æ³•æ„æ€
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/20/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/3%20%E5%BA%94%E7%94%A8%E5%88%9B%E5%BB%BA/">
                     
										    3 åº”ç”¨åˆ›å»º
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/20/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/4%20%E4%B8%96%E7%95%8C%E5%AE%9A%E4%B9%89/">
                     
										    4 ä¸–ç•Œå®šä¹‰
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/20/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/5%20%E6%91%84%E5%83%8F%E6%9C%BA%E5%AE%9A%E4%B9%89/">
                     
										    5 æ‘„åƒæœºå®šä¹‰
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/20/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/6%20%E7%9D%80%E8%89%B2%E5%99%A8%E5%AE%9A%E4%B9%89/">
                     
										    6 ç€è‰²å™¨å®šä¹‰
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/21/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/7%20%E5%A4%96%E9%83%A8%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/">
                     
										    7 å¤–éƒ¨èµ„æºç®¡ç†
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/21/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/8%20%E5%AF%B9%E8%B1%A1/">
                     
										    8 å¯¹è±¡
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/21/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/9%20%E5%AF%B9%E8%B1%A1%E7%BD%91%E6%A0%BC/">
                     
										    9 å¯¹è±¡ç½‘æ ¼
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/21/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/1%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/2%20%E5%AE%9E%E8%B7%B5/%E6%95%B0%E6%8D%AE%E9%A9%B1%E5%8A%A8%E7%9A%84%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA/">
                     
										    å¯¹è±¡å­˜å‚¨
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										2 æ•°å€¼åˆ†æ
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										å¸¸å¾®åˆ†æ–¹ç¨‹æ•°å€¼è§£æ³•
									</a>
									
							<ul>
								<li class="file active">
									<a href="/2025/07/29/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/2%20%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E6%95%B0%E5%80%BC%E8%A7%A3%E6%B3%95/%E4%B8%80%E9%98%B6%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/">
                     
										    ä¸€é˜¶å¸¸å¾®åˆ†æ–¹ç¨‹
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										æ’å€¼
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/26/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/2%20%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90/%E6%8F%92%E5%80%BC/%E7%BB%AA%E8%AE%BA/">
                     
										    ç»ªè®º
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										3 è®¾è®¡æ¨¡å¼ç»éªŒä¹‹è°ˆ
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/07/17/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/3%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%B0%88/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/">
                     
										    æ¶æ„è®¾è®¡
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/09/18/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/C++%20Pro/">
                     
										    C++ Pro
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										FAQ
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/09/04/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/FAQ/Cpp/">
                     
										    Cpp
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/09/16/2%20%E5%AD%A6%E4%B9%A0/3%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/Qt-Pro/">
                     
										    Qt Pro
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										3 æ€è€ƒ
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/07/02/3%20%E6%80%9D%E8%80%83/%E6%80%BB%E7%BB%93%E5%8F%8D%E6%80%9D%E4%B8%8E%E5%B1%95%E6%9C%9B/">
                     
										    ç¡•å£«ä¸‰å¹´åº”è¯¥æ€æ ·åº¦è¿‡
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										4 æ‚é¡¹
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										1 å®ç”¨å°å·¥å…·
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/19/4%20%E6%9D%82%E9%A1%B9/1%20%E5%AE%9E%E7%94%A8%E5%B0%8F%E5%B7%A5%E5%85%B7/1%20%E4%BB%A3%E7%A0%81%E6%89%81%E5%B9%B3%E5%8C%96%E5%B0%8F%E5%B7%A5%E5%85%B7/">
                     
										    1 ä»£ç æ‰å¹³åŒ–å°å·¥å…·
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/08/18/4%20%E6%9D%82%E9%A1%B9/1%20%E5%AE%9E%E7%94%A8%E5%B0%8F%E5%B7%A5%E5%85%B7/2%20%E5%90%84%E7%A7%8D%E5%8A%A0%E9%80%9F%E8%AE%BF%E9%97%AE/">
                     
										    2 å„ç§åŠ é€Ÿè®¿é—®
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/08/18/4%20%E6%9D%82%E9%A1%B9/1%20%E5%AE%9E%E7%94%A8%E5%B0%8F%E5%B7%A5%E5%85%B7/3%20%E6%90%9C%E7%B4%A2%E7%A5%9E%E5%99%A8/">
                     
										    3 æœç´¢ç¥å™¨
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										2 ç¯å¢ƒé…ç½®
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/09/16/4%20%E6%9D%82%E9%A1%B9/2%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/windows%20python%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/">
                     
										    windows pythonç¯å¢ƒé…ç½®
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/08/18/4%20%E6%9D%82%E9%A1%B9/2%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E7%94%B5%E8%84%91%E5%85%B1%E4%BA%AB%E7%A1%AC%E7%9B%98/">
                     
										    ç”µè„‘å…±äº«ç¡¬ç›˜
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										5 å®è·µ
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										è½¯ä»¶å¼€å‘
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/09/11/5%20%E5%AE%9E%E8%B7%B5/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/Qt%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E6%A0%87%E5%87%86%E5%8C%96%E6%B5%81%E7%A8%8B/">
                     
										    Qté¡¹ç›®å¼€å‘æ ‡å‡†åŒ–æµç¨‹
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										6 æ¸¸æˆ
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										1 minecraft
									</a>
									
							<ul>
								<li class="file">
									<a href="/2025/06/13/6%20%E6%B8%B8%E6%88%8F/1%20minecraft/01%20Better%20MC/">
                     
										    01 Better MC
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/13/6%20%E6%B8%B8%E6%88%8F/1%20minecraft/02%20%E8%84%86%E9%AA%A8%E7%97%87/">
                     
										    02 è„†éª¨ç—‡
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/14/6%20%E6%B8%B8%E6%88%8F/1%20minecraft/03%20%E5%B9%B8%E8%BF%90%E4%B8%96%E7%95%8C%E5%85%A5%E4%BE%B5/">
                     
										    03 å¹¸è¿ä¸–ç•Œå…¥ä¾µ
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2025/06/14/6%20%E6%B8%B8%E6%88%8F/1%20minecraft/04-Cisco-s-Fantasy-Medieval/">
                     
										    04 Cisco's Fantasy Medieval
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
		</div>
	</div>
</div>

	<!-- å¼•å…¥æ­£æ–‡ -->
	<div id="content" class="content">
		<h1 id="article-title">
	ä¸€é˜¶å¸¸å¾®åˆ†æ–¹ç¨‹
</h1>

<!-- meta -->
<div class="article-meta">
	

	<span>NicolasDavout</span>
	<span>2025-07-29 13:15:58</span>

  <div id="article-categories">
    
		  <span>Categoriesï¼š</span>
      
    

    
		    <span>Tagsï¼š</span>
        
    
  </div>

</div>

<!-- content -->
<div id="article-content">
	<h2 id="ä¸€é˜¶å¸¸å¾®åˆ†æ–¹ç¨‹åˆå€¼é—®é¢˜">ä¸€é˜¶å¸¸å¾®åˆ†æ–¹ç¨‹åˆå€¼é—®é¢˜</h2>
<h3 id="å”¯ä¸€è§£å­˜åœ¨æ€§">å”¯ä¸€è§£å­˜åœ¨æ€§</h3>
<h4 id="æ¡ä»¶">æ¡ä»¶</h4>
<p><span class="math display">\[
  \begin{cases}\frac{dy}{dx}=f(x,y),&amp;a\leq x\leq b;\\y(a)=\alpha.\end{cases}
  \tag{1}
\]</span></p>
<p>å¦‚æœå‡½æ•° <span class="math inline">\(f(x,y)\)</span> åœ¨åŒºåŸŸ <span class="math inline">\(\{a{\leqslant}x{\leqslant}b\:,\quad m{&lt;}y{&lt;}M\}\)</span> ä¸Šè¿ç»­ï¼Œä¸”å…³äº <span class="math inline">\(y\)</span> æ»¡è¶³ Lipschitz æ¡ä»¶
<span class="math display">\[
  \begin{vmatrix}f(x,y_1)-f(x,y_2)\end{vmatrix}\leq L\begin{vmatrix}y_1-y_2\end{vmatrix},\quad\forall y_1,y_2,
  \tag{2}
\]</span>
å…¶ä¸­ <span class="math inline">\(L&gt;0\)</span> ä¸º Lipschitz å¸¸æ•°ï¼Œé‚£ä¹ˆ <span class="formula-ref" data-formula="\begin{cases}\frac{dy}{dx}=f(x,y),&amp;a\leq x\leq b;\\y(a)=\alpha.\end{cases}">(1)</span> åœ¨ <span class="math inline">\(a\)</span> çš„æŸä¸ªé‚»åŸŸä¸Šå­˜åœ¨å”¯ä¸€è§£ã€‚</p>
<h4 id="è§£é‡Š">è§£é‡Š</h4>
<p>å¯¹äº <span class="math inline">\(f(x,y)\)</span> çš„é™åˆ¶æœ‰2ä¸ªï¼š</p>
<ul>
<li>è¿ç»­</li>
<li>å…³äº <span class="math inline">\(y\)</span> çš„ Lipschitz æ¡ä»¶</li>
</ul>
<p>Lipschitz æ¡ä»¶é™åˆ¶äº†å‡½æ•° <span class="math inline">\(f(x,y)\)</span> éš <span class="math inline">\(y\)</span> å˜åŒ–ç‡ä¸ä¼šå¤ªå¿«ã€‚</p>
<p>å¦å¤–ä¸€ä¸ªå……åˆ†æ¡ä»¶æ˜¯ï¼šå¦‚æœ <span class="math inline">\(\frac{\partial f}{\partial y}\)</span> åœ¨åŒºåŸŸå†…è¿ç»­æœ‰ç•Œï¼Œé‚£ä¹ˆ Lipschitz æ¡ä»¶æˆç«‹ã€‚</p>
<p>åœ¨è¿ç»­æ¡ä»¶ä¸‹ï¼šå¦‚æœ Lipschitz æ¡ä»¶ä¸æˆç«‹ï¼Œè¯´æ˜ <span class="math inline">\(f(x,y)\)</span> éš <span class="math inline">\(y\)</span> å˜åŒ–ç‡åœ¨æŸç‚¹ä¼šæ— é™å¤§ï¼Œ <span class="math inline">\(\frac{\partial f}{\partial y}\)</span> æ— ç•Œã€‚</p>
<h4 id="ä¸æ»¡è¶³-lipschitz-æ¡ä»¶ä¾‹å­">ä¸æ»¡è¶³ Lipschitz æ¡ä»¶ä¾‹å­</h4>
<p><span class="math display">\[
  y&#39;=2\sqrt{|y|}
  \tag{3}
\]</span></p>
<p>å¯ä»¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªè§£ï¼š <span class="math inline">\(y(x)=0\)</span></p>
<p>ç¬¬äºŒä¸ªè§£
<span class="math display">\[
  y(x)=\begin{cases}x^2,&amp;x\geq0\\-x^2,&amp;x&lt;0&amp;\end{cases}
  \tag{4}
\]</span>
è¯´æ˜å¹¶éå”¯ä¸€è§£ï¼Œä¸‹é¢å¯¹ Lipschitz æ¡ä»¶è¿›è¡Œåˆ¤æ–­</p>
<p>å– <span class="math inline">\(y_2=0\)</span> æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå¸¸æ•° <span class="math inline">\(L\)</span> ä½¿å¾—ï¼š
<span class="math display">\[
  \begin{aligned}&amp;|f(x,y_1)-f(x,0)|\leq L|y_1-0|\\&amp;|2\sqrt{y_1}-0|\leq L|y_1|\\&amp;2\sqrt{y_1}\leq Ly_1\end{aligned}
  \tag{5}
\]</span></p>
<p>å¯¹äº <span class="math inline">\(y_1&gt;0\)</span> æœ‰ï¼š
<span class="math display">\[
  L\geq\frac2{\sqrt{y_1}}
  \tag{6}
\]</span>
å¦‚æœ <span class="math inline">\(y_1\rightarrow0\)</span> æ— ç•Œï¼Œè¿™æ ·çš„ <span class="math inline">\(L\)</span> ä¸å­˜åœ¨</p>
<p>è¯´æ˜åœ¨ 0 é™„è¿‘ï¼Œ <span class="math inline">\(f(x,y)\)</span> éš <span class="math inline">\(y\)</span> å˜åŒ–ç‡è¿‡å¤§ï¼Œå‡ºç°äº†åˆ†å²”ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªç‰¹æ®Šæƒ…å†µæ»¡è¶³æ¡ä»¶ï¼Œè€Œè¿™äº›æƒ…å†µåœ¨ä¿æŒè¿ç»­æƒ…å†µä¸‹ä»»æ„ç»„åˆç»„æˆäº†æ— ç©·å¤šè§£ã€‚</p>
<p><img src="https://raw.githubusercontent.com/BenChenEternity/Images/main/20250729140609441.png" /></p>
<h4 id="è¯æ˜å­˜åœ¨æ€§ä¾‹å­">è¯æ˜å­˜åœ¨æ€§ä¾‹å­</h4>
<p><span class="math display">\[
  \begin{cases}\frac{dy}{dx}=1+x\sin(xy),&amp;0\leq x\leq2\\y(0)=1.\end{cases}
  \tag{7}
\]</span></p>
<p>æ˜¯å¦å­˜åœ¨å”¯ä¸€è§£ï¼Ÿ</p>
<p>æ˜¾ç„¶ <span class="math inline">\(f(x,y)=1+x\sin(xy)\)</span></p>
<p>å¯¹äºä»»æ„ <span class="math inline">\(y_1, y_2\)</span> å¯¹ <span class="math inline">\(y\)</span> åº”ç”¨å¾®åˆ†ä¸­å€¼å®šç†ï¼Œéƒ½å­˜åœ¨ <span class="math inline">\(\eta\)</span> ä½¿å¾—
<span class="math display">\[
  \frac{f(x,y_1)-f(x,y_2)}{y_1-y_2}=\frac\partial{\partial y}f(x,\eta)=x^2\cos(x\eta),
  \tag{8}
\]</span></p>
<p>äºæ˜¯
<span class="math display">\[
  \left|f(x,y_1)-f(x,y_2)\right|=\left|x^2\cos(x\eta)\right|\left|y_1-y_2\right|\leq4\left|y_1-y_2\right|,
  \tag{9}
\]</span>
æ»¡è¶³æ¡ä»¶ <span class="formula-ref" data-formula="\begin{vmatrix}f(x,y_1)-f(x,y_2)\end{vmatrix}\leq L\begin{vmatrix}y_1-y_2\end{vmatrix},\quad\forall y_1,y_2,">(2)</span> ï¼Œæ‰€ä»¥å­˜åœ¨ <span class="formula-ref" data-formula="\begin{cases}\frac{dy}{dx}=1+x\sin(xy),&amp;0\leq x\leq2\\y(0)=1.\end{cases}">(7)</span> å”¯ä¸€è§£</p>
<h3 id="å·®åˆ†æ³•">å·®åˆ†æ³•</h3>
<p>é¦–å…ˆä»‹ç»åŸºç¡€çš„å·®åˆ†æ³•ã€‚</p>
<h4 id="åŸç†">åŸç†</h4>
<p><span class="math display">\[
  \begin{cases}\frac{dy}{dx}=f(x,y),&amp;a\leq x\leq b;\\y(a)=\alpha.\end{cases}
  \tag{10}
\]</span></p>
<p>å‡è®¾è§£ <span class="math inline">\(y=y(x)\)</span> å”¯ä¸€å­˜åœ¨å¹¶å…‰æ»‘ï¼Œç›®æ ‡æ˜¯æ±‚è§£ç²¾ç¡®è§£ <span class="math inline">\(y(x)\)</span> åœ¨èŠ‚ç‚¹ <span class="math inline">\(x_i\)</span> ä¸Šçš„å€¼ <span class="math inline">\(y(x_i)\)</span> çš„è¿‘ä¼¼å€¼ <span class="math inline">\(y_i\)</span> å…¶ä¸­ <span class="math inline">\(i=1,2,\cdots,N\)</span></p>
<p><strong>åŒºé—´åˆ’åˆ†</strong></p>
<p>å¯¹ <span class="math inline">\([a,b]\)</span> åŒºé—´ç­‰è·åˆ’åˆ†ä¸º <span class="math inline">\(N\)</span> ä¸ªåŒºé—´ã€‚å…¶ä¸­æ­¥é•¿ä¸º <span class="math inline">\(h=\frac{b-a}{N}\)</span></p>
<p>æ¯ä¸ªèŠ‚ç‚¹ <span class="math inline">\(x_i=a+ih\)</span> å…¶ä¸­ <span class="math inline">\(i=0,1,\cdots,N\)</span></p>
<p><strong>åŒºé—´ç§¯åˆ†</strong></p>
<p>å¯¹ <span class="formula-ref" data-formula="y(x_{i+1})-y(x_i)=\int_{x_i}^{x_{i+1}}f(x,y(x))dx"><span class="formula-ref" data-formula="\begin{cases}\frac{dy}{dx}=f(x,y),&amp;a\leq x\leq b;\\y(a)=\alpha.\end{cases}">(10)</span></span> ç¬¬ä¸€å¼åœ¨ <span class="math inline">\([x_i,x_{i+1}]\)</span> åŒºé—´ä¸Šä¸¤ç«¯åŒæ—¶ç§¯åˆ†ï¼Œæœ‰ï¼š
<span class="math display">\[
  y(x_{i+1})-y(x_i)=\int_{x_i}^{x_{i+1}}f(x,y(x))dx
  \tag{11}
\]</span></p>
<p>å¯¹å…¬å¼ <span class="formula-ref" data-formula="y(x_{i+1})-y(x_i)=\int_{x_i}^{x_{i+1}}f(x,y(x))dx">(11)</span> çš„å³ä¾§è¿›è¡Œä¸åŒçš„æ•°å€¼ç§¯åˆ†å…¬å¼é€¼è¿‘ï¼Œå¯å¾—åˆ°ä¸åŒçš„å·®åˆ†å…¬å¼</p>
<p><strong>åŒºé—´ç§¯åˆ†è¿‘ä¼¼</strong></p>
<p>ä¸‹é¢æè¿°å¸¸è§çš„ç§¯åˆ†è¿‘ä¼¼åŠæ³•</p>
<p><img src="https://raw.githubusercontent.com/BenChenEternity/Images/main/20250729151022242.png" />
<span class="math display">\[
  \begin{aligned}&amp;\text{æ¢¯å½¢å…¬å¼(çº¢è‰²)}&amp;&amp;\int_a^bf(x)dx\approx\frac{b-a}2[f(a)+f(b)]\\&amp;\text{å·¦çŸ©å½¢å…¬å¼(ç»¿è‰²)}&amp;&amp;\int_a^bf(x)dx\approx(b-a)f(a)\\&amp;\text{å³çŸ©å½¢å…¬å¼(æ·±çº¢è‰²)}&amp;&amp;\int_a^bf(x)dx\approx(b-a)f(b)\\&amp;\text{ä¸­çŸ©å½¢å…¬å¼(ç²‰è‰²)}&amp;&amp;\int_a^bf(x)dx\approx(b-a)f(\frac{a+b}2)\end{aligned}
  \tag{12}
\]</span>
æ¢¯å½¢å…¬å¼å’Œä¸­çŸ©å½¢å…¬å¼çš„ç²¾åº¦è¾ƒé«˜</p>
<h4 id="è¿‘ä¼¼å…¬å¼">è¿‘ä¼¼å…¬å¼</h4>
<p><strong>æ¬§æ‹‰æ–¹æ³•</strong></p>
<p>å¯¹ <span class="formula-ref" data-formula="y(x_{i+1})-y(x_i)=\int_{x_i}^{x_{i+1}}f(x,y(x))dx">(11)</span> çš„å³è¾¹ä½¿ç”¨å·¦çŸ©å½¢å…¬å¼ï¼Œæœ‰
<span class="math display">\[
  y(x_{i+1})\approx y(x_i)+hf(x_i,y(x_i))
  \tag{13}
\]</span>
æ‰€ä»¥å·®åˆ†å…¬å¼çš„é€’æ¨å¼ä¸ºï¼š
<span class="math display">\[
  \begin{cases}y_{i+1}=y_i+hf(x_i,y_i)\\\\y_0=\alpha,&amp;,i=0,1,2,\cdots,N-1\end{cases}
  \tag{14}
\]</span></p>
<p><strong>æ¢¯å½¢æ–¹æ³•</strong></p>
<p>å¯¹ <span class="formula-ref" data-formula="y(x_{i+1})-y(x_i)=\int_{x_i}^{x_{i+1}}f(x,y(x))dx">(11)</span> çš„å³è¾¹ä½¿ç”¨ä¸­çŸ©å½¢å…¬å¼ï¼Œæœ‰
<span class="math display">\[
  \begin{cases}y_{i+1}=y_i+\frac{h}{2}[f(x_i,y_i)+f(x_{i+1},y_{i+1})]\\y_0=\alpha,&amp;,i=0,1,2\cdots,N-1\end{cases}
  \tag{15}
\]</span>
å› ä¸ºä¸¤è¾¹éƒ½å«æœ‰ <span class="math inline">\(y_{i+1}\)</span> éœ€è¦è§£æ–¹ç¨‹è®¡ç®—æ‰€ä»¥ç§°ä¸ºéšå¼å…¬å¼ï¼Œä½†æ˜¯ç²¾åº¦è¾ƒé«˜</p>
<p><strong>æ¬§æ‹‰ä¸­ç‚¹æ–¹æ³•</strong></p>
<p>å¯¹ <span class="math inline">\([x_{i-1},x_{i+1}]\)</span> ç§¯åˆ†
<span class="math display">\[
  \begin{cases}y_{i+1}=y_{i-1}+2hf(x_i,y_i)\\\\y_0=\alpha&amp;,i=1,2\cdots,N-1\end{cases}
  \tag{16}
\]</span>
å› ä¸ºè¦ç”¨åˆ°å‰ä¸¤æ­¥çš„ç»“æœï¼Œæ‰€ä»¥ç§°ä¸ºä¸¤æ­¥æ–¹æ³•</p>
<p><span class="math inline">\(\begin{aligned}&amp;\text{å…¬å¼åç§°}&amp;&amp;\text{ä¸»è¦æ ¼å¼}&amp;&amp;\text{æ˜¾å¼/éšå¼}&amp;&amp;\text{å•æ­¥/å¤šæ­¥}&amp;&amp;\text{ç²¾åº¦}\\&amp;\text{Eulerå…¬å¼}&amp;&amp;y(x_{i+1})\approx y(x_i)+hf(x_i,y(x_i))&amp;&amp;\text{å•æ­¥}&amp;&amp;\text{æ˜¾å¼}&amp;&amp;\text{ç¨å·®}\\&amp;\text{æ¢¯å½¢å…¬å¼}&amp;&amp;y_{i+1}=y_{i}+\frac{h}{2}[f(x_i,y_{i})+f(x_{i+1},y_{i+1})]&amp;&amp;\text{å•æ­¥}&amp;&amp;\text{éšå¼}&amp;&amp;\text{è¾ƒé«˜}\\&amp;\text{Eulerä¸­ç‚¹å…¬å¼}&amp;&amp;y_{i+1}=y_{i-1}+2hf(x_i,y_{i})&amp;&amp;\text{å¤šæ­¥}&amp;&amp;\text{æ˜¾å¼}&amp;&amp;\text{è¾ƒé«˜}\end{aligned}\)</span></p>
<p><strong>æ”¹è¿›çš„æ¬§æ‹‰æ–¹æ³•</strong></p>
<p>é’ˆå¯¹æ¢¯å½¢å…¬å¼ <span class="formula-ref" data-formula="\begin{cases}y_{i+1}=y_i+\frac{h}{2}[f(x_i,y_i)+f(x_{i+1},y_{i+1})]\\y_0=\alpha,&amp;,i=0,1,2\cdots,N-1\end{cases}">(15)</span> ï¼Œæ¯ä¸€æ­¥è¿ç®—è§£éçº¿æ€§æ–¹ç¨‹è®¡ç®—é‡å¤§ã€‚å¯¹äºå³ä¾§çš„ <span class="math inline">\(f(x_{i+1},y_{i+1})\)</span> æ¯ä¸€æ­¥é‡‡ç”¨æ¬§æ‹‰å…¬å¼æ¥è¿‘ä¼¼è®¡ç®—ã€‚</p>
<p>åŸºæœ¬æ€è·¯æ˜¯ï¼šé¢„æµ‹-æ ¡æ­£</p>
<p>å¯¹äºæ¯ä¸€æ­¥ï¼š</p>
<ul>
<li>è®¡ç®—å½“å‰æ–œç‡ <span class="math inline">\(k_i=f(x_i,y_i)\)</span></li>
<li>é¢„æµ‹ä¸‹ä¸€ç‚¹ <span class="math inline">\(y_{i+1}^*=y_i+h\times k_i\)</span></li>
<li>é¢„æµ‹ä¸‹ä¸€ç‚¹æ–œç‡ <span class="math inline">\(k_{i+1}=f(x_{i+1},y_{i+1}^*)\)</span></li>
<li>è®¡ç®—å¹³å‡æ–œç‡ï¼ˆæ¢¯å½¢å…¬å¼ï¼‰ <span class="math inline">\(y_{i+1}=y_i+\frac{h}{2}(k_1+k_2)\)</span></li>
</ul>
<p>æœ€ç»ˆå…¬å¼ä¸º
<span class="math display">\[
  y_{i+1}=y_i+\frac h2[f(x_i,y_i)+f(x_{i+1},y_i+hf(x_i,y_i))]
  \tag{17}
\]</span>
åˆå§‹æ¡ä»¶ <span class="math inline">\(y(x_0)=y_0\)</span></p>
<p><strong>æ³°å‹’é«˜é˜¶æ–¹æ³•</strong></p>
<p>ä½¿ç”¨æ³°å‹’å±•å¼€å…¬å¼å°† <span class="math inline">\(y(x_{i+1})\)</span> åœ¨ <span class="math inline">\(x_{i}\)</span> å¤„ <span class="math inline">\(p\)</span> é˜¶å±•å¼€
<span class="math display">\[
  y(x_{i+1})=y(x_{i})+hf(x_{i},y(x_{i}))+\frac{h^{2}}{2!}f^{(0)}(x_{i},y(x_{i}))+\cdots+\frac{h^{p}}{p!}f^{(p-1)}(x_{i},y(x_{i}))+O(h^{p+1})
  \tag{18}
\]</span>
æ·»åŠ åˆå§‹æ¡ä»¶ <span class="math inline">\(y(x_0)=y_0\)</span> ä¹Ÿå¯ä»¥å¾—åˆ°å·®åˆ†å…¬å¼</p>
<p>å½“ <span class="math inline">\(p=1\)</span> æ—¶ï¼Œé€€åŒ–ä¸ºæ¬§æ‹‰å…¬å¼ <span class="formula-ref" data-formula="\begin{cases}y_{i+1}=y_i+hf(x_i,y_i)\\\\y_0=\alpha,&amp;,i=0,1,2,\cdots,N-1\end{cases}">(14)</span></p>
<p>ä½†æ˜¯æ¬¡æ–¹æ³•å®ç°è¿‘ä¼¼éœ€è¦æ±‚è§£ <span class="math inline">\(f\)</span> çš„ <span class="math inline">\(p\)</span> é˜¶å¯¼æ•°ï¼Œä½†æ˜¯é«˜é˜¶å¯¼æ•°éå¸¸éš¾æ±‚è§£ã€‚å±•å¼€åˆ°é«˜é˜¶æå‡ç²¾åº¦ä¸ç°å®ã€‚</p>
<h4 id="è¯¯å·®åˆ†æ">è¯¯å·®åˆ†æ</h4>
<p>å›é¡¾ï¼š</p>
<ul>
<li>äºŒå…ƒæ³°å‹’å±•å¼€
<span class="math display">\[
\begin{aligned}f(x_{n}+h,y_{n}+k)&amp;=f(x_{n},y_{n})+\frac{\partial f(x_{n},y_{n})}{\partial x}h+\frac{\partial f(x_{n},y_{n})}{\partial y}k\\&amp;+\frac{1}{2!}\biggl[\frac{\partial^{2}f(x_{n},y_{n})}{\partial x^{2}}h^{2}+2\frac{\partial^{2}f(x_{n},y_{n})}{\partial x\partial y}hk+\frac{\partial^{2}f(x_{n},y_{n})}{\partial y^{2}}k^{2}\biggr]+\cdots\\&amp;+\frac{1}{k!}\biggl[h\frac{\partial}{\partial x}+k\frac{\partial}{\partial y}\biggr]^{k}f(x_{n},y_{n})+\cdots\cdots\end{aligned}
\tag{19}
\]</span></li>
</ul>
<p>æ³¨æ„ï¼šä½™é¡¹è¡¨è¾¾å¼ï¼š <span class="math inline">\(O((h+k)^{k+1})\)</span></p>
<ul>
<li><span class="math inline">\(y\)</span> çš„å¯¼æ•°</li>
</ul>
<p><span class="math inline">\(y&#39;=f(x,y)\)</span> ï¼Œè®° <span class="math inline">\(y&#39;(x_n)=f_n\)</span>
<span class="math display">\[
  y&#39;&#39;(x_n)=\frac{\partial f}{\partial x}(x_n,y_n)+\frac{\partial f}{\partial y}(x_n,y_n)y&#39;(x_n)=\frac{\partial f_n}{\partial x}+\frac{\partial f_n}{\partial y}f_n\\
  y^{\prime\prime}(x_n)=\frac{\partial^2f_n}{\partial x^2}+2\frac{\partial^2f_n}{\partial x\partial y}f_n+\frac{\partial^2f_n}{\partial y^2}f_n^2+\frac{\partial f_n}{\partial x}\frac{\partial f_n}{\partial y}+(\frac{\partial f_n}{\partial y})^2f_n
  \tag{20}
\]</span></p>
<p><strong>æ¬§æ‹‰å…¬å¼è¯¯å·®åˆ†æ</strong></p>
<p>å·²çŸ¥æ¬§æ‹‰å…¬å¼ï¼Œç»“æœä¸ºä¼°è®¡ç»“æœ
<span class="math display">\[
  y_{i+1}=y_i+hf(x_i,y_i)
  \tag{21}
\]</span>
<span class="math inline">\(y(x_{n+1})\)</span> æ˜¯ç²¾ç¡®ç»“æœï¼Œå¯¹å…¶è¿›è¡Œå±•å¼€
<span class="math display">\[
  y(x_{i+1})=y(x_i+h)=y(x_i)+y^{\prime}(x_i)h+\frac{y^{\prime\prime}(x_i)}{2!}h^2+O(h^3)
  \tag{22}
\]</span>
é‚£ä¹ˆç»“åˆ <span class="formula-ref" data-formula="y_{i+1}=y_i+hf(x_i,y_i)">(21)</span><span class="formula-ref" data-formula="y(x_{i+1})=y(x_i+h)=y(x_i)+y^{\prime}(x_i)h+\frac{y^{\prime\prime}(x_i)}{2!}h^2+O(h^3)">(22)</span> å¯å¾—å±€éƒ¨æˆªæ–­è¯¯å·®
<span class="math display">\[
  y(x_{i+1})-y_{i+1}=\frac{y^{\prime\prime}(x_i)}{2!}h^2+O(h^3)=O(h^2)
  \tag{23}
\]</span>
æ‰€ä»¥æ¬§æ‹‰å…¬å¼æ˜¯1é˜¶æ–¹æ³•ï¼Œç²¾ç¡®åˆ°1é˜¶ï¼Œ2é˜¶ä»¥åä¸å¤Ÿç²¾ç¡®ã€‚</p>
<p><strong>æ”¹è¿›æ¬§æ‹‰å…¬å¼è¯¯å·®åˆ†æ</strong></p>
<p>æˆ‘ä»¬æŠŠå¼ <span class="formula-ref" data-formula="y_{i+1}=y_i+\frac h2[f(x_i,y_i)+f(x_{i+1},y_i+hf(x_i,y_i))]">(17)</span> å…¶ä¸­çš„ <span class="math inline">\(f(x_i,y_i)\)</span> è¡¨ç¤ºä¸º <span class="math inline">\(f(x_i,y_i)=K=f_i\)</span></p>
<p>é‚£ä¹ˆ <span class="formula-ref" data-formula="y_{i+1}=y_i+\frac h2[f(x_i,y_i)+f(x_{i+1},y_i+hf(x_i,y_i))]">(17)</span> è¡¨ç¤ºä¸º
<span class="math display">\[
  y_{i+1}=y_i+\frac h2[K+f(x_{i+1},y_i+hK)]
  \tag{24}
\]</span>
å…¶ä¸­
<span class="math display">\[
  \begin{aligned}
  f(x_{i+1}, y_{i}+hK) &amp;=\\
  f(x_{i}+h, y_{i}+hK) &amp;= f_{i} + \frac{\partial f_{i}}{\partial x}h + \frac{\partial f_{i}}{\partial y}hK \\
  &amp;\quad + \frac{1}{2} \biggl[ \frac{\partial^{2} f_{i}}{\partial x^{2}} h^{2} + 2\frac{\partial^{2} f_{i}}{\partial x \partial y} h^{2} K + \frac{\partial^{2} f_{i}}{\partial y^{2}} h^{2} K^{2} \biggr] + O(h^{3})
  \end{aligned}
  \tag{25}
\]</span>
<span class="formula-ref" data-formula="\begin{aligned}
  f(x_{i+1}, y_{i}+hK) &amp;=\\
  f(x_{i}+h, y_{i}+hK) &amp;= f_{i} + \frac{\partial f_{i}}{\partial x}h + \frac{\partial f_{i}}{\partial y}hK \\
  &amp;\quad + \frac{1}{2} \biggl[ \frac{\partial^{2} f_{i}}{\partial x^{2}} h^{2} + 2\frac{\partial^{2} f_{i}}{\partial x \partial y} h^{2} K + \frac{\partial^{2} f_{i}}{\partial y^{2}} h^{2} K^{2} \biggr] + O(h^{3})
  \end{aligned}">(25)</span> ä»£å…¥ <span class="formula-ref" data-formula="y_{i+1}=y_i+\frac h2[K+f(x_{i+1},y_i+hK)]">(24)</span> ï¼ŒåŒæ—¶ <span class="math inline">\(f(x_i,y_i)=K=f_i\)</span> å¾—åˆ°ï¼š
<span class="math display">\[
  y_{i+1} = y_i + f_i h + \frac{h^2}{2} \left[ \frac{\partial f_i}{\partial x} + \frac{\partial f_i}{\partial y} f_i \right] + \frac{h^3}{4} \left[ \frac{\partial^{2} f_i}{\partial x^{2}} + 2\frac{\partial^{2} f_i}{\partial x \partial y} f_i + \frac{\partial^{2} f_i}{\partial y^{2}} f_i^{2} \right] + O(h^{4})
  \tag{26}
\]</span>
<span class="formula-ref" data-formula="y_{i+1} = y_i + f_i h + \frac{h^2}{2} \left[ \frac{\partial f_i}{\partial x} + \frac{\partial f_i}{\partial y} f_i \right] + \frac{h^3}{4} \left[ \frac{\partial^{2} f_i}{\partial x^{2}} + 2\frac{\partial^{2} f_i}{\partial x \partial y} f_i + \frac{\partial^{2} f_i}{\partial y^{2}} f_i^{2} \right] + O(h^{4})">(26)</span> å¾—åˆ°çš„æ˜¯ä¼°è®¡å€¼ï¼Œä¸‹é¢è®¡ç®—çœŸå®å€¼ï¼Œå¯¹ <span class="math inline">\(y(x_{i+1})\)</span> æ³°å‹’å±•å¼€
<span class="math display">\[
  y(x_{i+1}) = y(x_{i}) + y^{\prime}(x_{i}) h + \frac{y^{\prime\prime}(x_{i})}{2} h^{2} + \frac{y^{\prime\prime\prime}(x_{i})}{3!} h^{3} + O(h^{4})
  \tag{27}
\]</span>
æŠŠ <span class="formula-ref" data-formula="y&#39;&#39;(x_n)=\frac{\partial f}{\partial x}(x_n,y_n)+\frac{\partial f}{\partial y}(x_n,y_n)y&#39;(x_n)=\frac{\partial f_n}{\partial x}+\frac{\partial f_n}{\partial y}f_n\\
  y^{\prime\prime}(x_n)=\frac{\partial^2f_n}{\partial x^2}+2\frac{\partial^2f_n}{\partial x\partial y}f_n+\frac{\partial^2f_n}{\partial y^2}f_n^2+\frac{\partial f_n}{\partial x}\frac{\partial f_n}{\partial y}+(\frac{\partial f_n}{\partial y})^2f_n">(20)</span> ä»£å…¥ <span class="formula-ref" data-formula="y(x_{i+1}) = y(x_{i}) + y^{\prime}(x_{i}) h + \frac{y^{\prime\prime}(x_{i})}{2} h^{2} + \frac{y^{\prime\prime\prime}(x_{i})}{3!} h^{3} + O(h^{4})">(27)</span> ï¼Œå¾—åˆ°çœŸå®å€¼
<span class="math display">\[
  \begin{aligned}
  y(x_{i+1}) &amp;= y(x_i) + y^{\prime}(x_i) h + \frac{y^{\prime\prime}(x_i)}{2} h^2 + \frac{y^{\prime\prime\prime}(x_i)}{3!} h^3 + O(h^4) \\
  &amp;= y_i + f_i h + \frac{h^2}{2} \left[ \frac{\partial f_i}{\partial x} + \frac{\partial f_i}{\partial y} f_i \right] \\
  &amp;\quad + \frac{h^3}{6} \left[ \frac{\partial^{2} f_i}{\partial x^{2}} + 2\frac{\partial^{2} f_i}{\partial x \partial y} f_i + \frac{\partial^{2} f_i}{\partial y^{2}} f_i^{2} + \frac{\partial f_i}{\partial x} \frac{\partial f_i}{\partial y} + \left(\frac{\partial f_i}{\partial y}\right)^{2} f_i \right] + O(h^{4})
  \end{aligned}
  \tag{28}
\]</span>
ç»“åˆ <span class="formula-ref" data-formula="y_{i+1} = y_i + f_i h + \frac{h^2}{2} \left[ \frac{\partial f_i}{\partial x} + \frac{\partial f_i}{\partial y} f_i \right] + \frac{h^3}{4} \left[ \frac{\partial^{2} f_i}{\partial x^{2}} + 2\frac{\partial^{2} f_i}{\partial x \partial y} f_i + \frac{\partial^{2} f_i}{\partial y^{2}} f_i^{2} \right] + O(h^{4})">(26)</span><span class="formula-ref" data-formula="\begin{aligned}y(x_{n+1})&amp;=y(x_n)+y^{\prime}(x_n)h+\frac{y^{\prime\prime}(x_n)}2h^2+\frac{y^{\prime\prime\prime}(x_n)}{3!}h^3+O(h^4)\\&amp;=y_n+f_nh+\frac{h^2}2\left[\frac{\partial f_n}{\partial x}+\frac{\partial f_n}{\partial y}f_n\right]\end{aligned}"><span class="formula-ref" data-formula="\begin{aligned}
  y(x_{i+1}) &amp;= y(x_i) + y^{\prime}(x_i) h + \frac{y^{\prime\prime}(x_i)}{2} h^2 + \frac{y^{\prime\prime\prime}(x_i)}{3!} h^3 + O(h^4) \\
  &amp;= y_i + f_i h + \frac{h^2}{2} \left[ \frac{\partial f_i}{\partial x} + \frac{\partial f_i}{\partial y} f_i \right] \\
  &amp;\quad + \frac{h^3}{6} \left[ \frac{\partial^{2} f_i}{\partial x^{2}} + 2\frac{\partial^{2} f_i}{\partial x \partial y} f_i + \frac{\partial^{2} f_i}{\partial y^{2}} f_i^{2} + \frac{\partial f_i}{\partial x} \frac{\partial f_i}{\partial y} + \left(\frac{\partial f_i}{\partial y}\right)^{2} f_i \right] + O(h^{4})
  \end{aligned}">(28)</span></span> ä¸¤å¼å¾—åˆ°æˆªæ–­è¯¯å·®
<span class="math display">\[
  y(x_{i+1})-y_{i+1}=O(h^3)
  \tag{29}
\]</span></p>
<h3 id="runge-kutta-æ–¹æ³•">Runge-Kutta æ–¹æ³•</h3>
<p>æ­¤æ–¹æ³•æºè‡ªå·®åˆ†æ³•ï¼Œå‰é¢è¯´åˆ°æ³°å‹’æ–¹æ³•éœ€è¦æ±‚é«˜é˜¶å¯¼æ•°è®¡ç®—å¤æ‚ã€‚</p>
<h4 id="åŸºæœ¬åŸç†">åŸºæœ¬åŸç†</h4>
<blockquote>
<ul>
<li>è®¡ç®—åˆå§‹ç‚¹æ–œç‡ <span class="math inline">\(k_1=f(t_i,y_i)\)</span></li>
<li>åˆ©ç”¨ <span class="math inline">\(k_1\)</span> ä¼°è®¡åŒºé—´ä¸­ç‚¹ <span class="math inline">\(t_i+\frac{h}{2}\)</span> æ–œç‡ <span class="math inline">\(k_2=f(t_i+\frac{h}{2},y_i+k_1\frac{h}{2})\)</span></li>
<li>åˆ©ç”¨ <span class="math inline">\(k_2\)</span> ä¼°è®¡åŒºé—´ä¸­ç‚¹ <span class="math inline">\(t_i+\frac{h}{2}\)</span> æ–œç‡ <span class="math inline">\(ğ‘˜_3= f(t_i+\frac{h}{2},y_i+k_2\frac{h}{2})\)</span></li>
<li>â€¦</li>
<li>åˆ©ç”¨ <span class="math inline">\(k_{p-1}\)</span> ä¼°è®¡åŒºé—´ä¸­ç‚¹ <span class="math inline">\(t_i+\frac{h}{2}\)</span> æ–œç‡ <span class="math inline">\(ğ‘˜_p= f(t_i+\frac{h}{2},y_i+k_{p-1}\frac{h}{2})\)</span></li>
<li>å¯¹å„ç‚¹æ–œç‡åŠ æƒå¹³å‡ä¼°è®¡ <span class="math inline">\(y_{i+1}=y_i+h(\lambda_1k_1+\lambda_2k_2+...+\lambda_nk_n)\)</span></li>
</ul>
</blockquote>
<p>å¦‚æœæˆ‘ä»¬ä¸ç”¨åŒºé—´ä¸­ç‚¹ä¼°è®¡ï¼Œæ·»åŠ å‚æ•°è°ƒæ•´ä¼°è®¡ç‚¹ä½ç½®ï¼Œå…¬å¼å¦‚ä¸‹
<span class="math display">\[
  \begin{cases}&amp;y_{i+1}=y_{i}+h(\lambda_{1}K_{1}+\lambda_{2}K_{2}+\cdots+\lambda_{p}K_{p})\\&amp;K_{1}=f(x_{i},y_{i})\\&amp;K_{2}=f(x_{i}+\alpha_{2}h,y_{i}+\beta_{21}K_{1}h)\\&amp;......\\&amp;K_{P}=f(x_{i}+\alpha_{p}h,y_{i}+(\sum_{i=1}^{p-1}\beta_{pi}K_{i})h)\end{cases}
  \tag{30}
\]</span></p>
<p>å…¶ä¸­ <span class="math inline">\(\lambda\)</span> <span class="math inline">\(\alpha\)</span> <span class="math inline">\(\beta\)</span> æ˜¯å‚æ•°ï¼Œ</p>
<ul>
<li><span class="math inline">\(\lambda\)</span> æ˜¯æƒé‡ç³»æ•°ï¼Œè¡¨ç¤ºå„ä¸ªæ–œç‡çš„æƒé‡åˆ†é…</li>
<li><span class="math inline">\(\alpha\)</span> æ˜¯æ¨ªåæ ‡ç³»æ•°ï¼Œå†³å®šæ¨ªåæ ‡å¦‚ä½•å–å€¼</li>
<li><span class="math inline">\(\beta\)</span> æ˜¯çºµåæ ‡ç³»æ•°ï¼Œå†³å®šçºµåæ ‡å¦‚ä½•å–å€¼</li>
</ul>
<h4 id="å‚æ•°å–å€¼åˆ†æ">å‚æ•°å–å€¼åˆ†æ</h4>
<p>ä¸Šè¿°å‚æ•°å½±å“ç»“æœè¯¯å·®</p>
<p>æˆ‘ä»¬å…ˆå¯¹ <span class="math inline">\(p=2\)</span> çš„æ—¶å€™å¼€å§‹åˆ†æï¼ŒäºŒé˜¶å…¬å¼å¦‚ä¸‹
<span class="math display">\[
  \begin{cases}&amp;y_{i+1}=y_{i}+h(\lambda_{1}K_{1}+\lambda_{2}K_{2})\\&amp;K_{1}=f(x_{i},y_{i})\\&amp;K_{2}=f(x_{i}+\alpha h,y_{i}+\beta K_{1}h)\\\end{cases}
  \tag{31}
\]</span>
ä»£å…¥ç¬¬ä¸€å¼å¾—ï¼š
<span class="math display">\[
  \begin{aligned}
  y_{i+1} &amp;= y_i+\lambda_1hf(x_i,y_i)+\lambda_2hf(x_i+\alpha h,y_i+\beta f(x_i,y_i)h)
  \\&amp;=y_i+\lambda_1hf_i+\lambda_2hf(x_i+\alpha h,y_i+\beta f_ih)
  \end{aligned}
  \tag{32}
\]</span></p>
<p>å¯¹ <span class="formula-ref" data-formula="\begin{aligned}
  y_{i+1} &amp;= y_i+\lambda_1hf(x_i,y_i)+\lambda_2hf(x_i+\alpha h,y_i+\beta f(x_i,y_i)h)
  \\&amp;=y_i+\lambda_1hf_i+\lambda_2hf(x_i+\alpha h,y_i+\beta f_ih)
  \end{aligned}">(32)</span> çš„æœ€åä¸€é¡¹çš„äºŒå…ƒå‡½æ•° <span class="math inline">\(f\)</span> æ³°å‹’å±•å¼€
<span class="math display">\[
  f(x_i+\alpha h,y_i+\beta f_ih)=f_i+\frac{\partial f_i}{\partial x}\alpha h+\frac{\partial f_i}{\partial y}\beta f_i h+O((\alpha h+\beta f_ih)^3)
  \tag{33}
\]</span>
å…¶ä¸­ä½™é¡¹ <span class="math inline">\(O((\alpha h+\beta f_ih)^3)=O(h^3)\)</span></p>
<p>æŠŠ <span class="formula-ref" data-formula="f(x_i+\alpha h,y_i+\beta f_ih)=f_i+\frac{\partial f_i}{\partial x}\alpha h+\frac{\partial f_i}{\partial y}\beta f_i h+O((\alpha h+\beta f_ih)^3)">(33)</span> ä»£å…¥ <span class="formula-ref" data-formula="\begin{aligned}
  y_{i+1} &amp;= y_i+\lambda_1hf(x_i,y_i)+\lambda_2hf(x_i+\alpha h,y_i+\beta f(x_i,y_i)h)
  \\&amp;=y_i+\lambda_1hf_i+\lambda_2hf(x_i+\alpha h,y_i+\beta f_ih)
  \end{aligned}">(32)</span> å¾—åˆ°ä¼°è®¡å€¼ï¼š
<span class="math display">\[
  y_{i+1}=y_{i}+h(\lambda_{1}+\lambda_{2})f_{i}+h^{2}\lambda_{2}\left(\alpha\:\frac{\partial f_{i}}{\partial x}+\beta f_{i}\:\frac{\partial f_{i}}{\partial y}\right)+O(h^{3})
  \tag{34}
\]</span>
å¯¹ç²¾ç¡®å€¼è¿›è¡Œæ³°å‹’å±•å¼€åˆ°åŒé˜¶
<span class="math display">\[
  y(x_{i+1})=y_{i}+hf_{i}+\frac{h^{2}}{2}\biggl(\frac{\partial f_{i}}{\partial x}+f_{i}\:\frac{\partial f_{i}}{\partial y}\biggr)+O(h^{3})
  \tag{35}
\]</span></p>
<p>å°†ç»“åˆ <span class="formula-ref" data-formula="y_{i+1}=y_{i}+h(\lambda_{1}+\lambda_{2})f_{i}+h^{2}\lambda_{2}\left(\alpha\:\frac{\partial f_{i}}{\partial x}+\beta f_{i}\:\frac{\partial f_{i}}{\partial y}\right)+O(h^{3})">(34)</span><span class="formula-ref" data-formula="y(x_{i+1})=y_{i}+hf_{i}+\frac{h^{2}}{2}\biggl(\frac{\partial f_{i}}{\partial x}+f_{i}\:\frac{\partial f_{i}}{\partial y}\biggr)+O(h^{3})">(35)</span> å¯å¾—ï¼š</p>
<p>åªéœ€è¦æ»¡è¶³
<span class="math display">\[
  \begin{cases}
  \lambda_1+\lambda_2&amp;=1
  \\a\lambda_2&amp;=\frac{1}{2}
  \\\beta \lambda_2&amp;=\frac{1}{2}
  \end{cases}
  \tag{36}
\]</span>
å°±å¯ä»¥å®ç°æˆªæ–­è¯¯å·®åˆ° <span class="math inline">\(O(h^3)\)</span></p>
<p>ä¸‹é¢æˆ‘ä»¬å¯¹ç‰¹æ®Šå‚æ•°å–å€¼è¿›è¡Œåˆ†æ</p>
<p><strong>å¦‚æœ <span class="math inline">\(\alpha=1\)</span> é‚£ä¹ˆ <span class="math inline">\(\lambda_1=\lambda_2=\frac{1}{2}, \beta=1\)</span></strong></p>
<p>æ­¤æ—¶å…¬å¼ä¸º
<span class="math display">\[
  \begin{cases}y_{i+1}=y_i+\frac{h}{2}(K_1+K_2)\\\\K_1=f(x_i,y_i)\\\\K_2=f(x_i+h,y_i+hK_1)\end{cases}
  \tag{37}
\]</span>
å°±æ˜¯æ”¹è¿›æ¬§æ‹‰å…¬å¼</p>
<p><strong>å¦‚æœ <span class="math inline">\(\lambda_1=0\)</span> é‚£ä¹ˆ <span class="math inline">\(\lambda_2=1, \alpha=\beta=\frac{1}{2}\)</span></strong></p>
<p>æ­¤æ—¶å…¬å¼ä¸º
<span class="math display">\[
  y_{i+1}=y_{i}+hf(x_{i}+\frac{1}{2}h,y_{i}+\frac{1}{2}hf(x_{i},y_{i}))
  \tag{38}
\]</span>
å°±æ˜¯ä¸­ç‚¹å…¬å¼</p>
<p>å¯¹äºæ›´é«˜é˜¶çš„ R-K å…¬å¼ï¼š</p>
<p><strong>ä¸‰é˜¶</strong>
<span class="math display">\[
  \begin{cases}&amp;y_{i+1}=y_i+\frac{h}{6}(K_1+4K_2+K_3)\\&amp;K_1=f(x_i,y_i)\\&amp;K_2=f(x_i+\frac12h,y_i+\frac12hK_1)\\&amp;K_3=f(x_i+h,y_i-hK_1+2hK_2)\end{cases}
  \tag{39}
\]</span>
<strong>å››é˜¶</strong>
<span class="math display">\[
  \begin{cases}
  &amp;y_{n+1}=y_{n}+\frac{\mathbf{h}}{6}(K_{1}+2K_{2}+2K_{3}+K_{4}) \\
  &amp;K_{1}=f(x_{n},y_{n}) \\
  &amp;K_{2}=f(x_{n}+\frac{1}{2}h, y_{n}+\frac{1}{2}hK_{1}) \\
  &amp;K_{3}=f(x_{n}+\frac{1}{2}h, y_{n}+\frac{1}{2}hK_{2}) \\
  &amp;K_{4}=f(x_{n}+h, y_{n}+hK_{3})
  \end{cases}
  \tag{40}
\]</span>
å¯¹äºäº”é˜¶ä»¥ä¸Šçš„ R-K å…¬å¼ä¸å†æœ‰ä¸å…¶çº§æ•°ç›¸åŒ¹é…çš„è¯¯å·®é˜¶ï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨ä¸‰é˜¶æˆ–è€…å››é˜¶çš„ R-K å…¬å¼</p>
<h4 id="éšå¼-r-k-æ–¹æ³•">éšå¼ R-K æ–¹æ³•</h4>
<p>ä¸‹é¢æ˜¯ p çº§çš„éšå¼ R-K æ–¹æ³•è¡¨è¾¾å¼
<span class="math display">\[
  \begin{cases}y_{i+1}=y_i+h\sum\limits_{r=1}^p\lambda_rK_r\\K_r=f(x_i+\alpha_rh,y_i+h\sum\limits_{j=1}^r\lambda_{rj}K_j)\end{cases},r=1,2,\cdots,p
  \tag{41}
\]</span>
å¦‚æœ R-K æ–¹æ³•åœ¨æ–¹ç¨‹å·¦å³ä¸¤è¾¹éƒ½æœ‰æœªçŸ¥æ•° <span class="math inline">\(K_r\)</span>ï¼Œéœ€è¦ä¾èµ–è§£æ–¹ç¨‹æ¥æ±‚è§£ã€‚</p>
<p>å½“ p=2 æ—¶ï¼Œ
<span class="math display">\[
  \begin{cases}y_{i+1}=y_i+\frac12h(K_1+K_2)\\K_1=f(x_i,y_i)\\K_2=f(x_i+h,y_i+\frac12hK_1+\frac12hK_2)\end{cases}
  \tag{42}
\]</span>
æ­¤å¼å°±æ˜¯æ¢¯å½¢å…¬å¼ï¼ŒäºŒé˜¶</p>
<p>p çº§ R-K æ–¹æ³•çš„é˜¶æœ‰æ—¶å¯èƒ½å¤§äº p</p>
<p>è€ƒè™‘ä¸€çº§éšå¼ä¸­ç‚¹å…¬å¼
<span class="math display">\[
  \begin{cases}y_{i+1}=y_i+hK_1\\K_1=f(x_i+\frac{1}{2}h,y_i+\frac{1}{2}hK_1)\end{cases}
  \tag{43}
\]</span>
ä¹Ÿå¯ä»¥å†™æˆ
<span class="math display">\[
  y_{i+1}=y_i+hf(x_i+\frac12h,\frac12(y_i+y_{i+1}))
  \tag{44}
\]</span>
æ˜¯äºŒé˜¶æ–¹æ³•</p>
<p><strong>ç‰¹ç‚¹</strong></p>
<p>éšå¼æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºæ•°å€¼ç¨³å®šæ€§å¥½ï¼Œä½†æ˜¯è®¡ç®—é‡å¤§</p>
<h3 id="å˜æ­¥é•¿çš„å·®åˆ†æ³•">å˜æ­¥é•¿çš„å·®åˆ†æ³•</h3>
<h4 id="èƒŒæ™¯">èƒŒæ™¯</h4>
<p>å¯¹äº <span class="math inline">\(f(x,y)\)</span> çš„ä¸åŒåŒºé—´ï¼š</p>
<ul>
<li>åœ¨é™¡çš„éƒ¨åˆ†ï¼Œæ­¥é•¿è¿‡å¤§ï¼Œè¯¯å·®å¤§</li>
<li>åœ¨ç¼“çš„éƒ¨åˆ†ï¼Œæ­¥é•¿è¿‡å°ï¼Œæ•ˆç‡ä½</li>
</ul>
<p>ä¸ºäº†è¿½æ±‚è¯¯å·®å’Œæ•ˆç‡çš„å¹³è¡¡ï¼Œé‡‡ç”¨å˜æ­¥é•¿çš„æ–¹æ³•ã€‚åœ¨é™¡çš„éƒ¨åˆ†æ­¥é•¿å‡å°ï¼Œç¼“çš„éƒ¨åˆ†æ­¥é•¿å¢å¤§ã€‚</p>
<h4 id="å˜æ­¥é•¿-runge-kutta-æ–¹æ³•">å˜æ­¥é•¿ Runge-Kutta æ–¹æ³•</h4>
<p>å‡è®¾åœ¨ <span class="math inline">\(x_i\)</span> ä»¥æ­¥é•¿ <span class="math inline">\(h\)</span> è®¡ç®—ç²¾ç¡®å€¼ <span class="math inline">\(y(x_{i+1})\)</span> çš„è¿‘ä¼¼å€¼ä¸º <span class="math inline">\(y_{i+1}^{(h)}\)</span> ï¼Œæˆªæ–­è¯¯å·®ä¸º <span class="math inline">\(y(x_{i+1})-y_{i+1}^{(h)}=Ch^{p+1}\)</span></p>
<p>å…¶ä¸­ <span class="math inline">\(C\)</span> æ˜¯å¸¸æ•°ï¼Œå°†æ­¥é•¿å‡åŠ <span class="math inline">\(y(x_{i+1})-y_{i+1}^{(\frac{h}{2})}\approx2C(\frac{h}{2})^{p+1}=\frac{1}{2^p}Ch^{p+1}\)</span>
<span class="math display">\[
  \frac{y(x_{i+1})-y_{i+1}^{(\frac h2)}}{y(x_{i+1})-y_{i+1}^{(h)}}\approx\frac1{2^p}
  \tag{45}
\]</span>
ä¹Ÿå°±æ˜¯è¯´åœ¨æ­¥é•¿å‡åŠä¹‹åï¼Œå±€éƒ¨é˜¶æ®µè¯¯å·®å˜æˆåŸæ¥çš„ <span class="math inline">\(\frac{1}{2^p}\)</span></p>
<p>æ•´ç† <span class="formula-ref" data-formula="\frac{y(x_{i+1})-y_{i+1}^{(\frac h2)}}{y(x_{i+1})-y_{i+1}^{(h)}}\approx\frac1{2^p}">(45)</span> å¯å¾—ï¼š
<span class="math display">\[
y(x_{i+1})-y_{i+1}^{(\frac h2)}\approx\frac1{2^p-1}(y_{i+1}^{(\frac h2)}-y_{i+1}^{(h)})
  \tag{46}
\]</span></p>
<p>å½“ $y_{i+1}<sup>{(h2)}-y_{i+1}</sup>{(h)}$ æˆç«‹ï¼Œå– <span class="math inline">\(y(x_{i+1})\approx y_{i+1}^{(\frac h2)}\)</span> ï¼Œå³åœ¨è¯¯å·®å…è®¸èŒƒå›´å†…ï¼Œä½¿ç”¨è¿‘ä¼¼å€¼ä¼°è®¡ç²¾ç¡®å€¼ã€‚</p>
<p>å¦åˆ™ï¼Œå°†æ­¥é•¿å‡åŠï¼Œå†æ¬¡è®¡ç®—ç›´åˆ°åœ¨ç²¾åº¦èŒƒå›´å†…ã€‚</p>
<h2 id="ä»£ç å®ç°æ¯”è¾ƒä¸åŒå·®åˆ†æ–¹æ³•æ¯”è¾ƒ">ä»£ç å®ç°æ¯”è¾ƒä¸åŒå·®åˆ†æ–¹æ³•æ¯”è¾ƒ</h2>
<p>ä»£ç å¦‚ä¸‹ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œå°†ä¸åŒçš„å·®åˆ†è¿‘ä¼¼æ–¹æ³•å°è£…è¿›å…·ä½“ç­–ç•¥ç±»ã€‚</p>
<p>æ¯”è¾ƒç²¾ç¡®çš„ODEè§£æ›²çº¿ä½¿ç”¨åº“æ¥ç”»å‡ºæ¥ï¼Œå†ç”»å‡ºä¸åŒè¿‘ä¼¼æ–¹æ³•ä¸‹ç ”ç©¶åŒºé—´å†…å„ä¸ªç‚¹çš„å·®åˆ†è®¡ç®—ç»“æœã€‚</p>
<p>æˆ‘ä»¬å¯¹ <span class="math inline">\(\frac{dy}{dx}=sin\ x+cos\ y\)</span> ä½¿ç”¨ä¸åŒå·®åˆ†æ³•è¿‘ä¼¼ï¼Œå–æ­¥æ•°ä¸º5ï¼ŒåŒºé—´ä»1åˆ°3ï¼Œç»“æœå¦‚ä¸‹ã€‚</p>
<p><img src="https://raw.githubusercontent.com/BenChenEternity/Images/main/20250811022214522.png" /></p>
<p>ä»ç»“æœåˆ†æï¼Œä¸­çŸ©å½¢è¿‘ä¼¼å’Œå’Œæ¢¯å½¢è¿‘ä¼¼è¯¯å·®è¾ƒå°ï¼Œè€Œä¸”æ˜¾å¼å’Œéšå¼çš„æ¢¯å½¢è¿‘ä¼¼è¯¯å·®ä¸å¤§ã€‚</p>
<p>ä»£ç å¦‚ä¸‹</p>
<pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">from</span> abc <span class="hljs-keyword">import</span> ABC, abstractmethod
<span class="hljs-keyword">from</span> scipy.optimize <span class="hljs-keyword">import</span> root
<span class="hljs-keyword">from</span> scipy.integrate <span class="hljs-keyword">import</span> solve_ivp


<span class="hljs-comment"># --------------------------------------------------------------------------</span>
<span class="hljs-comment"># 1. ç­–ç•¥æ¥å£å’Œå…·ä½“ç­–ç•¥ç±» (Strategy Interface and Concrete Strategies)</span>
<span class="hljs-comment"># --------------------------------------------------------------------------</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegrationStrategy</span>(<span class="hljs-title class_ inherited__">ABC</span>):
    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    æŠ½è±¡ç­–ç•¥åŸºç±»ï¼Œå®šä¹‰äº†æ•°å€¼ç§¯åˆ†çš„æ¥å£ã€‚</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

<span class="hljs-meta">    @abstractmethod</span>
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self, f, xn, yn, h</span>):
        <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">        æ ¹æ®ç‰¹å®šå…¬å¼è®¡ç®— y_&#123;n+1&#125;</span>
<span class="hljs-string"></span>
<span class="hljs-string">        å‚æ•°:</span>
<span class="hljs-string">        f (callable): å¾®åˆ†æ–¹ç¨‹çš„å³ç«¯å‡½æ•° f(x, y)</span>
<span class="hljs-string">        xn (float): å½“å‰çš„ x å€¼</span>
<span class="hljs-string">        yn (float): å½“å‰çš„ y å€¼</span>
<span class="hljs-string">        h (float): æ­¥é•¿</span>
<span class="hljs-string"></span>
<span class="hljs-string">        è¿”å›:</span>
<span class="hljs-string">        float: y çš„ä¸‹ä¸€ä¸ªå€¼ y_&#123;n+1&#125;</span>
<span class="hljs-string">        &quot;&quot;&quot;</span>
        <span class="hljs-keyword">pass</span>


<span class="hljs-keyword">class</span> <span class="hljs-title class_">LeftRectangleStrategy</span>(<span class="hljs-title class_ inherited__">IntegrationStrategy</span>):
    <span class="hljs-string">&quot;&quot;&quot;å·¦çŸ©å½¢å…¬å¼ (å³å‰å‘æ¬§æ‹‰æ³•)æ˜¾å¼&quot;&quot;&quot;</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self, f, xn, yn, h</span>):
        <span class="hljs-keyword">return</span> yn + h * f(xn, yn)


<span class="hljs-keyword">class</span> <span class="hljs-title class_">RightRectangleStrategy</span>(<span class="hljs-title class_ inherited__">IntegrationStrategy</span>):
    <span class="hljs-string">&quot;&quot;&quot;å³çŸ©å½¢å…¬å¼ (å³åå‘æ¬§æ‹‰æ³•)éšå¼&quot;&quot;&quot;</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self, f, xn, yn, h</span>):
        x_next = xn + h
        equation_to_solve = <span class="hljs-keyword">lambda</span> y_next: y_next - yn - h * f(x_next, y_next)
        initial_guess = yn + h * f(xn, yn)
        solution = root(equation_to_solve, initial_guess)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> solution.success:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;è§£æ–¹ç¨‹å¤±è´¥&quot;</span>)
        <span class="hljs-keyword">return</span> solution.x[<span class="hljs-number">0</span>]


<span class="hljs-keyword">class</span> <span class="hljs-title class_">ImplicitTrapezoidStrategy</span>(<span class="hljs-title class_ inherited__">IntegrationStrategy</span>):
    <span class="hljs-string">&quot;&quot;&quot;æ¢¯å½¢å…¬å¼ (éšå¼)&quot;&quot;&quot;</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self, f, xn, yn, h</span>):
        x_next = xn + h
        f_xn_yn = f(xn, yn)
        equation_to_solve = <span class="hljs-keyword">lambda</span> y_next: y_next - yn - (h / <span class="hljs-number">2.0</span>) * (f_xn_yn + f(x_next, y_next))
        initial_guess = yn + h * f_xn_yn
        solution = root(equation_to_solve, initial_guess)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> solution.success:
            <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f&quot;éšå¼æ¢¯å½¢æ³•åœ¨ x=<span class="hljs-subst">&#123;xn&#125;</span> å¤„è§£æ–¹ç¨‹å¤±è´¥: <span class="hljs-subst">&#123;solution.message&#125;</span>&quot;</span>)
        <span class="hljs-keyword">return</span> solution.x[<span class="hljs-number">0</span>]


<span class="hljs-keyword">class</span> <span class="hljs-title class_">TrapezoidStrategy</span>(<span class="hljs-title class_ inherited__">IntegrationStrategy</span>):
    <span class="hljs-string">&quot;&quot;&quot;æ¢¯å½¢å…¬å¼ (å³æ”¹è¿›æ¬§æ‹‰æ³•æˆ–Heunæ³•)&quot;&quot;&quot;</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self, f, xn, yn, h</span>):
        y_predictor = yn + h * f(xn, yn)
        <span class="hljs-keyword">return</span> yn + (h / <span class="hljs-number">2.0</span>) * (f(xn, yn) + f(xn + h, y_predictor))


<span class="hljs-keyword">class</span> <span class="hljs-title class_">MidpointStrategy</span>(<span class="hljs-title class_ inherited__">IntegrationStrategy</span>):
    <span class="hljs-string">&quot;&quot;&quot;ä¸­çŸ©å½¢å…¬å¼ (å³æ˜¾å¼ä¸­ç‚¹æ³•)&quot;&quot;&quot;</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self, f, xn, yn, h</span>):
        k_mid = f(xn + h / <span class="hljs-number">2.0</span>, yn + (h / <span class="hljs-number">2.0</span>) * f(xn, yn))
        <span class="hljs-keyword">return</span> yn + h * k_mid


<span class="hljs-comment"># --------------------------------------------------------------------------</span>
<span class="hljs-comment"># 2. ä¸Šä¸‹æ–‡ç±» (Context Class)</span>
<span class="hljs-comment"># --------------------------------------------------------------------------</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ODESolver</span>:
    <span class="hljs-string">&quot;&quot;&quot;</span>
<span class="hljs-string">    ä¸€é˜¶å¾®åˆ†æ–¹ç¨‹æ±‚è§£å™¨ (ä¸Šä¸‹æ–‡)ã€‚</span>
<span class="hljs-string">    å®ƒæŒæœ‰ä¸€ä¸ªç­–ç•¥å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥æ±‚è§£æ–¹ç¨‹ã€‚</span>
<span class="hljs-string">    &quot;&quot;&quot;</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, strategy: IntegrationStrategy</span>):
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">isinstance</span>(strategy, IntegrationStrategy):
            <span class="hljs-keyword">raise</span> TypeError(<span class="hljs-string">&quot;strategy å¿…é¡»æ˜¯ IntegrationStrategy çš„ä¸€ä¸ªå®ä¾‹&quot;</span>)
        <span class="hljs-variable language_">self</span>._strategy = strategy

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">set_strategy</span>(<span class="hljs-params">self, strategy: IntegrationStrategy</span>):
        <span class="hljs-variable language_">self</span>._strategy = strategy

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>(<span class="hljs-params">self, f, y0, x_span, num_steps</span>):
        x_start, x_end = x_span
        h = (x_end - x_start) / num_steps
        x_values = np.linspace(x_start, x_end, num_steps + <span class="hljs-number">1</span>)
        y_values = np.zeros(num_steps + <span class="hljs-number">1</span>)
        y_values[<span class="hljs-number">0</span>] = y0
        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(num_steps):
            y_values[i + <span class="hljs-number">1</span>] = <span class="hljs-variable language_">self</span>._strategy.step(f, x_values[i], y_values[i], h)
        <span class="hljs-keyword">return</span> x_values, y_values


<span class="hljs-comment"># --------------------------------------------------------------------------</span>
<span class="hljs-comment"># 3. ä¸»ç¨‹åº (Main Execution)</span>
<span class="hljs-comment"># --------------------------------------------------------------------------</span>

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x, y</span>):
        <span class="hljs-keyword">return</span> np.sin(x) + np.cos(y)


    x0 = <span class="hljs-number">1.0</span>
    y0 = <span class="hljs-number">3.0</span>
    x_end = <span class="hljs-number">3.0</span>
    x_span = (x0, x_end)

    <span class="hljs-comment"># ----------------------------------------------------------------------</span>
    <span class="hljs-comment"># MODIFICATION 1: å‡å°‘æ­¥æ•°ä»¥æ”¾å¤§ä¸åŒæ–¹æ³•é—´çš„å·®å¼‚</span>
    <span class="hljs-comment"># ----------------------------------------------------------------------</span>
    num_steps = <span class="hljs-number">5</span>


    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_reference_solution</span>(<span class="hljs-params">f, y0, x_span</span>):
        sol = solve_ivp(f, x_span, [y0], dense_output=<span class="hljs-literal">True</span>, method=<span class="hljs-string">&#x27;RK45&#x27;</span>, atol=<span class="hljs-number">1e-12</span>, rtol=<span class="hljs-number">1e-12</span>)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> sol.success:
            <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">&quot;é«˜ç²¾åº¦å‚è€ƒè§£æ±‚è§£å¤±è´¥ï¼&quot;</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">lambda</span> x: sol.sol(x)[<span class="hljs-number">0</span>]


    reference_solution = create_reference_solution(f, y0, x_span)

    strategies = &#123;
        <span class="hljs-string">&quot;å·¦çŸ©å½¢è¿‘ä¼¼ï¼ˆæ¬§æ‹‰æ³• æ˜¾å¼ï¼‰&quot;</span>: (LeftRectangleStrategy(), <span class="hljs-string">&quot;green&quot;</span>),
        <span class="hljs-string">&quot;å³çŸ©å½¢è¿‘ä¼¼ï¼ˆéšå¼ï¼‰&quot;</span>: (RightRectangleStrategy(), <span class="hljs-string">&quot;darkred&quot;</span>),
        <span class="hljs-string">&quot;æ¢¯å½¢è¿‘ä¼¼ï¼ˆéšå¼ï¼‰&quot;</span>: (ImplicitTrapezoidStrategy(), <span class="hljs-string">&quot;blue&quot;</span>),
        <span class="hljs-string">&quot;æ¢¯å½¢è¿‘ä¼¼ï¼ˆæ”¹è¿›æ¬§æ‹‰æ³• æ˜¾å¼ï¼‰&quot;</span>: (TrapezoidStrategy(), <span class="hljs-string">&quot;red&quot;</span>),
        <span class="hljs-string">&quot;ä¸­çŸ©å½¢è¿‘ä¼¼ï¼ˆæ˜¾å¼ï¼‰&quot;</span>: (MidpointStrategy(), <span class="hljs-string">&quot;hotpink&quot;</span>),
    &#125;

    <span class="hljs-comment"># ----------------------------------------------------------------------</span>
    <span class="hljs-comment"># MODIFICATION 2: åˆ›å»ºä¸¤ä¸ªå­å›¾ï¼Œä¸€ä¸ªç”¨äºè§£ï¼Œä¸€ä¸ªç”¨äºè¯¯å·®</span>
    <span class="hljs-comment"># sharex=True è®©ä¸¤ä¸ªå­å›¾å…±äº«xè½´</span>
    <span class="hljs-comment"># ----------------------------------------------------------------------</span>
    fig, (ax1, ax2) = plt.subplots(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, figsize=(<span class="hljs-number">14</span>, <span class="hljs-number">12</span>), sharex=<span class="hljs-literal">True</span>)
    plt.style.use(<span class="hljs-string">&#x27;seaborn-v0_8-whitegrid&#x27;</span>)

    plt.rcParams[<span class="hljs-string">&#x27;font.sans-serif&#x27;</span>] = [<span class="hljs-string">&#x27;Microsoft YaHei&#x27;</span>]
    plt.rcParams[<span class="hljs-string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="hljs-literal">False</span>

    <span class="hljs-comment"># --- ç»˜åˆ¶ ä¸Šæ–¹å­å›¾: è§£å‡½æ•° ---</span>
    x_fine = np.linspace(x_span[<span class="hljs-number">0</span>], x_span[<span class="hljs-number">1</span>], <span class="hljs-number">200</span>)
    ax1.plot(x_fine, reference_solution(x_fine), <span class="hljs-string">&#x27;k--&#x27;</span>, label=<span class="hljs-string">&quot;ç²¾ç¡®è§£&quot;</span>, linewidth=<span class="hljs-number">2.5</span>)

    <span class="hljs-comment"># --- ç»˜åˆ¶ ä¸‹æ–¹å­å›¾: è¯¯å·® ---</span>
    <span class="hljs-comment"># å…ˆç”»ä¸€æ¡ y=0 çš„åŸºå‡†çº¿ï¼Œæ–¹ä¾¿å¯¹æ¯”</span>
    ax2.axhline(<span class="hljs-number">0</span>, color=<span class="hljs-string">&#x27;black&#x27;</span>, linestyle=<span class="hljs-string">&#x27;--&#x27;</span>, linewidth=<span class="hljs-number">1</span>)

    <span class="hljs-comment"># --- å¾ªç¯æ±‚è§£ã€è®¡ç®—è¯¯å·®å¹¶ç»˜å›¾ ---</span>
    <span class="hljs-keyword">for</span> name, (strategy_instance, color) <span class="hljs-keyword">in</span> strategies.items():
        solver = ODESolver(strategy_instance)
        x_num, y_num = solver.solve(f, y0, x_span, num_steps)

        <span class="hljs-comment"># ç»˜åˆ¶è§£å‡½æ•°åˆ° ax1</span>
        ax1.plot(x_num, y_num, <span class="hljs-string">&#x27;o-&#x27;</span>, label=name, color=color, markersize=<span class="hljs-number">5</span>)

        <span class="hljs-comment"># è®¡ç®—ç»å¯¹è¯¯å·®</span>
        y_exact_at_steps = reference_solution(x_num)
        <span class="hljs-comment"># åŠ ä¸Šä¸€ä¸ªå¾ˆå°çš„æ•°ï¼Œé¿å… log(0) é”™è¯¯</span>
        error = np.<span class="hljs-built_in">abs</span>(y_num - y_exact_at_steps) + <span class="hljs-number">1e-16</span>

        <span class="hljs-comment"># ç»˜åˆ¶è¯¯å·®åˆ° ax2</span>
        ax2.plot(x_num, error, <span class="hljs-string">&#x27;o-&#x27;</span>, label=<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;name&#125;</span> è¯¯å·®&quot;</span>, color=color, markersize=<span class="hljs-number">5</span>)

    <span class="hljs-comment"># --- é…ç½®å›¾è¡¨ ---</span>
    ax1.set_title(<span class="hljs-string">f&quot;ä¸åŒå·®åˆ†æ³•æ±‚è§£ç»“æœ (æ­¥æ•°=<span class="hljs-subst">&#123;num_steps&#125;</span>)&quot;</span>, fontsize=<span class="hljs-number">16</span>)
    ax1.set_ylabel(<span class="hljs-string">&quot;y çš„è§£&quot;</span>, fontsize=<span class="hljs-number">12</span>)
    ax1.legend(fontsize=<span class="hljs-number">11</span>)
    ax1.grid(<span class="hljs-literal">True</span>)

    ax2.set_title(<span class="hljs-string">&quot;å„ç§æ–¹æ³•çš„ç»å¯¹è¯¯å·®ï¼ˆå¯¹æ•°åæ ‡ï¼‰&quot;</span>, fontsize=<span class="hljs-number">16</span>)
    ax2.set_xlabel(<span class="hljs-string">&quot;x&quot;</span>, fontsize=<span class="hljs-number">12</span>)
    ax2.set_ylabel(<span class="hljs-string">&quot;ç»å¯¹è¯¯å·® |y* - y|&quot;</span>, fontsize=<span class="hljs-number">12</span>)
    <span class="hljs-comment"># MODIFICATION 3: å°† y è½´è®¾ç½®ä¸ºå¯¹æ•°å°ºåº¦</span>
    ax2.set_yscale(<span class="hljs-string">&#x27;log&#x27;</span>)
    ax2.legend(fontsize=<span class="hljs-number">11</span>)
    ax2.grid(<span class="hljs-literal">True</span>, which=<span class="hljs-string">&quot;both&quot;</span>)  <span class="hljs-comment"># &#x27;both&#x27; åœ¨ä¸»æ¬¡åˆ»åº¦ä¸Šéƒ½æ˜¾ç¤ºç½‘æ ¼</span>

    <span class="hljs-comment"># è‡ªåŠ¨è°ƒæ•´å¸ƒå±€ï¼Œé˜²æ­¢æ ‡ç­¾é‡å </span>
    plt.tight_layout()
    plt.show()</code></pre>

</div>

<!-- post-guide -->

    <div class="post-guide">
        <div class="item left">
            
              <a href="/2025/08/18/4%20%E6%9D%82%E9%A1%B9/2%20%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E7%94%B5%E8%84%91%E5%85%B1%E4%BA%AB%E7%A1%AC%E7%9B%98/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  ç”µè„‘å…±äº«ç¡¬ç›˜
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2025/07/28/2%20%E5%AD%A6%E4%B9%A0/2%20%E5%8A%9B%E5%AD%A6/2%20%E8%AE%A1%E7%AE%97%E6%B5%81%E4%BD%93%E5%8A%9B%E5%AD%A6/SPH%E5%85%89%E6%BB%91%E7%B2%92%E5%AD%90%E6%B3%95/SPH%E6%96%B9%E6%B3%95%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/">
                SPHæ–¹æ³•åŸºæœ¬åŸç†
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>


<!-- comment - giscus -->


<!-- comment - valine -->


<script>
	
	
</script>

	</div>
	<div id="footer">
	<p>
		Â©<span id="footerYear-start">
			
		</span>-<span id="footerYear-end"></span>

		
				<a href="/">
					NicolasDavout
				</a>
				

					
							<br>
							Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
							by <a href="//wujun.me" target="_blank">Wu Jun</a>
							Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>


	<script type="text/javascript">
		document.getElementById('footerYear-start').innerHTML = new Date().getFullYear() + '';
	</script>
	
		<script type="text/javascript">
			document.getElementById('footerYear-end').innerHTML = new Date().getFullYear() + '';
		</script>
		
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>